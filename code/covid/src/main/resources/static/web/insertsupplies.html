<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <!--edge浏览器H5兼容设置-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--360浏览器H5兼容设置-->
    <meta name="renderer" content="webkit" />
    <title>covid-web</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--导入核心文件-->
    <script src="../bootstrap3/js/holder.js"></script>
    <link href="../bootstrap3/css/bootstrap.css" rel="stylesheet" type="text/css">
    <script src="../bootstrap3/jquery-1.8.3.min.js"></script>
    <script src="../bootstrap3/js/bootstrap.js"></script>
    <script src="../bootstrap3/js/echarts.min.js"></script>
    <script src="../bootstrap3/js/china.js"></script>
    <!-- 字体图标 -->
    <link rel="stylesheet" href="../bootstrap3/font-awesome-4.7.0/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="../css/layout.css" />
    <link rel="stylesheet" type="text/css" href="../css/webindex.css" />
    <link rel="stylesheet" type="text/css" href="../css/footer.css" />
    <link rel="stylesheet" type="text/css" href="../css/top.css" />
    <script src="../js/menu.js" type="text/javascript" charset="utf-8"></script>

    <style type="text/css">
        .divstyle{
            width: 1700px;
            height: 700px;
        }
    </style>
</head>

<body>
<!-- 头部 -->
<header class="header">
    <!--学子商城logo-->
    <div class="row">
        <div class="col-md-3">
        </div>
        <!--快捷选项-->
        <div class="col-md-9 top-item">
            <ul class="list-inline pull-right">
                <li></li>
                <li class="li-split"></li>
                <li></li>
                <li class="li-split"></li>
                <li></li>
                <li class="li-split"></li>
                <li>
                    <!--下列列表按钮 ：管理-->
                    <div class="btn-group">
                        <button type="button" class="btn btn-link dropdown-toggle"
                                data-toggle="dropdown">
								<span id="top-dropdown-btn"><span class="fa fa-gears"></span>&nbsp;管理
									<span class="caret"></span></span>
                        </button>
                        <ul class="dropdown-menu top-dropdown-ul" role="menu">
                            <li><a href="password.html">修改密码</a></li>
                            <li><a href="userdata.html">个人资料</a></li>
                        </ul>
                    </div>
                </li>
                <li class="li-split"></li>
                <li>
                </li>
            </ul>
        </div>
    </div>
</header>
<div class="row top-nav">
    <div class="col-md-6">
        <ul class="nav nav-pills">
            <li><a href="#"></a></li>
            <li class="active"><a href="index.html"><span
                    class="fa fa-home"></span></a></li>
            <li><a href="supplies.html">物资列表</a></li>
            <li><a href="insertsupplies.html">捐赠物资</a></li>
        </ul>
    </div>
    <div class="col-md-6">
        <form action="search.html" class="form-inline pull-right" role="form">
            <div class="form-group">
            </div>
        </form>
    </div>
</div>
</header>
<!--主体-->
<div class="container mycontent text-left">
    <!--透明层 -->
    <div class="loginDiv">
        <p>捐赠物资及个人信息</p>
        <!--表单开始-->
        <form id="form-addnew" class="form-horizontal" role="form">
            <div class="form-group">
                <label class="col-md-2 control-label"><span
                        class="txtred">*</span>捐赠人姓名：</label>
                <div class="col-md-8">
                    <input name="username" type="text" class="form-control"
                           placeholder="请输入捐赠人姓名">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span
                        class="txtred">*</span>物资名称：</label>
                <div class="col-md-8">
                    <input name="name" type="text" class="form-control"
                           placeholder="请输入物资名称">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span
                        class="txtred">*</span>物资单价：</label>
                <div class="col-md-8">
                    <input name="price" type="text" class="form-control"
                           placeholder="请输入物资单价">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span
                        class="txtred">*</span>物资数量：</label>
                <div class="col-md-8">
                    <input name="count" type="text" class="form-control"
                           placeholder="请输入物资数量">
                </div>
            </div>
            <div class="address_content" data-toggle="distpicker">
                <div class="form-group">
                    <label class="col-md-2 control-label"><span
                            class="txtred">*</span>省/直辖市：</label>
                    <div class="col-md-3">
                        <select name="provinceCode" class="form-control" data-province="---- 选择省 ----"
                                id="province-list"></select>
                    </div>
                    <label class="col-md-2 control-label"><span
                            class="txtred">*</span>城市：</label>
                    <div class="col-md-3">
                        <select name="cityCode" class="form-control" data-city="---- 选择市 ----"
                                id="city-list"></select>
                    </div>
                </div>
                <div class="form-group ">
                    <label class="col-md-2 control-label"><span
                            class="txtred">*</span>区县：</label>
                    <div class="col-md-3">
                        <select name="areaCode" class="form-control" data-district="---- 选择区 ----"
                                id="area-list"></select>
                    </div>
                    <label class="col-md-2 control-label">邮政编码：</label>
                    <div class="col-md-3">
                        <input name="zip" type="text" class="form-control"
                               placeholder="请输入邮政编码">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span
                        class="txtred">*</span>详细地址：</label>
                <div class="col-md-8">
								<textarea name="address" class="form-control" rows="3"
                                          placeholder="输入详细的收货地址，小区名称、门牌号等"></textarea>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span
                        class="txtred">*</span>手机：</label>
                <div class="col-md-3">
                    <input name="phone" type="text" class="form-control"
                           placeholder="请输入手机号码">
                </div>
                <label class="col-md-2 control-label">固话：</label>
                <div class="col-md-3">
                    <input name="tel" type="text" class="form-control"
                           placeholder="请输入固定电话号码">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">地址类型：</label>
                <div class="col-md-8">
                    <input name="tag" type="text" class="form-control"
                           placeholder="请输入地址类型，如：家、公司或者学校">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-sm-10">
                    <input id="btn-addnew" type="button"
                           class="col-md-1 btn btn-primary" value="提交表单" /> <input
                        type="reset" class="col-md-offset-1 col-md-1 btn btn-primary"
                        value="重置表单" />
                </div>
            </div>
        </form>
    </div>
</div>
<!--页脚开始-->
<footer class="footer">
    <!-- 品质保障，私人定制等-->
    <div class="text-center rights container">
        <div class="col-md-offset-2 col-md-2">
            <span class="fa fa-thumbs-o-up"></span>
            <p></p>
        </div>
        <div class="col-md-2">
            <span class="fa fa-address-card-o"></span>
            <p></p>
        </div>
        <div class="col-md-2">
            <span class="fa fa-graduation-cap"></span>
            <p></p>
        </div>
        <div class="col-md-2">
            <span class="fa fa-bitcoin"></span>
            <p></p>
        </div>
    </div>
    <!--联系我们、下载客户端等-->
    <div class="container beforeBottom">
        <div class="col-md-offset-1 col-md-3">
            <div>
                <img src="" alt="" class="footLogo" />
            </div>
            <div>
                <img src="" alt="" />
            </div>
        </div>
        <div class="col-md-4 callus text-center">
            <div class="col-md-4">
                <ul>
                    <li><a href="#"><p>covid帮助</p></a></li>
                    <li><a href="#">新手指南</a></li>
                    <li><a href="#">服务保障</a></li>
                    <li><a href="#">常见问题</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <ul>
                    <li><a href="#"><p>帮助</p></a></li>
                    <li><a href="#">入驻</a></li>
                    <li><a href="#">后台</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <ul>
                    <li><a href="#"><p>关于我们</p></a></li>
                    <li><a href="#">关于tyut</a></li>
                    <li><a href="#">联系我们</a></li>
                    <li><span class="fa fa-wechat"></span> <span
                            class="fa fa-weibo"></span></li>
                </ul>
            </div>
        </div>
        <div class="col-md-4">
            <div class="col-md-5">
            </div>
            <div class="col-md-6">
            </div>
        </div>
    </div>
    <!-- 页面底部-备案号 #footer -->
    <div class="col-md-12 text-center bottom">
        Copyright © 2022 tyut.cn All Rights Reserved 京ICP备000000000号-00 <a
            target="_blank" href="http://www2017.tyut.edu.cn/">太原理工大学软件工程</a>
    </div>
</footer>
<!--页脚结束-->
</body>

<script type="text/javascript">
    $(document).ready(function() {
        $("#btn-addnew").click(function() {
            addAddress();
        });

        showProvinceList();

        $("#province-list").change(function(){
            showCityList();

            $("#area-list").empty();
            var defaultOp = '<option value="-1">--- 请选择 ---</option>';
            $("#area-list").append(defaultOp);

        });

        $("#city-list").change(function(){
            showAreaList();
        });

    });

    function addAddress(){
        $.ajax({
            "url" : "/data/insertSupplies",
            "data" : $("#form-addnew").serialize(),
            "type" : "post",
            "dataType" : "json",
            "success" : function(json) {
                if (json.state == 2000) {
                    alert("添加物资成功！");
                    window.location.href = "http://localhost:8989/web/supplies.html";
                } else {
                    alert(json.message);
                }
            },
            "error" : function(){
                alert("您的登录信息已过期！请重新登录！");
            }
        });
    }

    function showProvinceList(){
        // 自定义“---请选择---”选项，避免页面自动选择 省 却不显示 市 的情况
        var defaultOp = '<option value="-1">--- 请选择 ---</option>';
        $("#province-list").append(defaultOp);
        $("#city-list").append(defaultOp);
        $("#area-list").append(defaultOp);

        $.ajax({
            "url" : "/districts/",
            "data" : "parent=0",
            "type" : "get",
            "dataType" : "json",
            "success" : function(json) {
                var list = json.data;
                console.log("count = " + list.length);
                for (var i = 0; i < list.length; i++) {
                    var op = '<option value="' + list[i].code + '">' + list[i].name + '</option>';
                    $("#province-list").append(op);
                }
            }
        });
    }

    function showCityList(){
        // 每次改变 省 时，要先清空 市数据
        $("#city-list").empty();

        // 市数据一清空，就显示  请选择
        var defaultOp = '<option value="-1">--- 请选择 ---</option>';
        $("#city-list").append(defaultOp);


        // 获取选择的 省 的代号
        var provinceCode = $("#province-list").val();
        // 如果为 -1 ，表示选中的是 “---请选择---”，此时直接 return，不再执行后续请求
        if(provinceCode == -1){
            return;
        }

        $.ajax({
            "url" : "/districts/",
            "data" : "parent=" + provinceCode,
            "type" : "get",
            "dataType" : "json",
            "success" : function(json) {
                var list = json.data;
                console.log("count = " + list.length);
                for (var i = 0; i < list.length; i++) {
                    var op = '<option value="' + list[i].code + '">' + list[i].name + '</option>';
                    $("#city-list").append(op);
                }
            }
        });
    }


    function showAreaList(){
        // 每次改变 市 时，要先清空 区数据
        $("#area-list").empty();

        // 区 数据清空，就显示 “请选择”
        var defaultOp = '<option value="-1">--- 请选择 ---</option>';
        $("#area-list").append(defaultOp);

        // 获取选择的 市 的代号
        var cityCode = $("#city-list").val();
        // 如果为 -1 ，表示选中的是 “---请选择---”，此时直接 return，不再执行后续请求
        if(cityCode == -1){
            return;
        }

        $.ajax({
            "url" : "/districts/",
            "data" : "parent=" + cityCode,
            "type" : "get",
            "dataType" : "json",
            "success" : function(json) {
                var list = json.data;
                console.log("count = " + list.length);
                for (var i = 0; i < list.length; i++) {
                    var op = '<option value="' + list[i].code + '">' + list[i].name + '</option>';
                    $("#area-list").append(op);
                }
            }
        });
    }


</script>

</html>